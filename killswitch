sudo ufw --force reset 
sudo ufw default deny incoming
sudo ufw default deny outgoing 
#sudo ufw allow out 53/udp # uncomment this line if your DNS requests are handled outside the tunnel, which might lead to a DNS Leak
if [ ! -z $1 ]
  then echo Adding current connection as exception for reconnection: $1
  sudo ufw allow out from any to $1  
fi
sudo ufw allow out from any to $(ip r | grep default | awk '{print $3}')
sudo ufw allow out on tun0 from any to any 
sudo ufw enable
